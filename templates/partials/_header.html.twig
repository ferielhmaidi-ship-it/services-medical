<header id="header" class="header d-flex align-items-center fixed-top">
  <div class="container position-relative d-flex align-items-center justify-content-between">

    <!-- Logo -->
    <a href="{{ path('app_home') }}" class="logo d-flex align-items-center me-auto me-xl-0">
      <h1 class="sitename">Tabib<span>Net</span></h1>
    </a>

    <nav id="navmenu" class="navmenu">
      <ul>
        <!-- Accueil -->
        <li><a href="{{ path('app_home') }}" class="{{ app.request.attributes.get('_route') == 'app_home' ? 'active' : '' }}">Accueil</a></li>
        <!-- Add this to your navigation menu (both for logged in and non-logged in users) -->
        <li><a href="{{ path('app_annuaire') }}" class="{{ app.request.attributes.get('_route') == 'app_annuaire' ? 'active' : '' }}"><i class="fas fa-book-medical me-1"></i>Annuaire Médical</a></li>

        <!-- À propos -->
        <li><a href="{{ path('app_about') }}" class="{{ app.request.attributes.get('_route') == 'app_about' ? 'active' : '' }}">À propos</a></li>

        {% if app.user %}
          <!-- Contenu spécifique à l'utilisateur -->
          {% if is_granted('ROLE_PATIENT') %}
            <!-- Trouver un médecin pour les patients -->
            <li><a href="{{ path('app_doctors') }}" class="{{ app.request.attributes.get('_route') == 'app_doctors' ? 'active' : '' }}">Trouver un Médecin</a></li>

            <!-- Prendre rendez-vous pour les patients -->
            <li><a href="{{ path('app_appointment') }}" class="{{ app.request.attributes.get('_route') == 'app_appointment' ? 'active' : '' }}">Prendre Rendez-vous</a></li>
          {% endif %}

          {% if is_granted('ROLE_ADMIN') %}
            <!-- Panneau d'administration -->
            <li><a href="{{ path('admin_dashboard') }}" class="{{ app.request.attributes.get('_route') starts with 'admin' ? 'active' : '' }}">Panneau Admin</a></li>
          {% endif %}

           {% if is_granted('ROLE_MEDECIN') %}
            <!-- Calendrier -->
            <li><a href="{{ path('app_calendrier') }}" class="{{ app.request.attributes.get('_route') == 'app_calendrier' ? 'active' : '' }}">Calendrier</a></li>

          {% endif %}

        {% else %}
          <!-- Utilisateurs non authentifiés -->
          <!-- Trouver un médecin (pour tous) -->
          <li><a href="{{ path('app_doctors') }}" class="{{ app.request.attributes.get('_route') == 'app_doctors' ? 'active' : '' }}">Trouver un Médecin</a></li>
        {% endif %}

        <!-- Toujours afficher Contact -->
        <li><a href="{{ path('app_contact') }}" class="{{ app.request.attributes.get('_route') == 'app_contact' ? 'active' : '' }}">Contact</a></li>

        <!-- Menu déroulant utilisateur (seulement connecté) -->
        {% if app.user %}
          <li class="dropdown">
            <a href="#">
              <span>
                <i class="fas fa-user-circle me-1"></i>
                {{ app.user.firstName }}
              </span>
              <i class="bi bi-chevron-down toggle-dropdown"></i>
            </a>
            <ul>
              <!-- Tableau de bord selon le rôle -->
              {% if is_granted('ROLE_ADMIN') %}
                <li>
                  <a href="{{ path('admin_dashboard') }}">
                    <i class="fas fa-tachometer-alt me-2"></i>Panneau Admin
                  </a>
                </li>
              {% elseif is_granted('ROLE_MEDECIN') %}
                <li>
                  <a href="{{ path('medecin_dashboard') }}">
                    <i class="fas fa-user-md me-2"></i>Mon Espace
                  </a>
                </li>
              {% elseif is_granted('ROLE_PATIENT') %}
                <li>
                  <a href="{{ path('patient_dashboard') }}">
                    <i class="fas fa-user-injured me-2"></i>Mon Espace
                  </a>
                </li>
              {% endif %}

              <li><hr class="dropdown-divider"></li>

              <li>
                <a href="{{ path('app_logout') }}">
                  <i class="fas fa-sign-out-alt me-2"></i>Déconnexion
                </a>
              </li>
            </ul>
          </li>
        {% else %}
          <!-- Connexion seulement -->
          <li>
            <a href="{{ path('app_login') }}" class="{{ app.request.attributes.get('_route') == 'app_login' ? 'active' : '' }}">
              <i class="fas fa-sign-in-alt me-1"></i>Connexion
            </a>
          </li>
        {% endif %}
      </ul>
      <i class="mobile-nav-toggle d-xl-none bi bi-list"></i>
    </nav>

  </div>
</header>